<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CryptoYieldPro — Dashboard</title>

  <!-- Inter (keeps premium look) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --black-1: #000000;
      --black-2: #050507;
      --panel: rgba(255,255,255,0.02);
      --panel-2: rgba(255,255,255,0.01);
      --accent: #a855f7;
      --accent-2: #5eead4;
      --muted: #9aa3b2;
      --white-90: rgba(255,255,255,0.92);
      --card-radius: 14px;
      --max-width: 1140px;
    }

    /* ---------- Reset & base ---------- */
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--black-1) 0%, var(--black-2) 100%);color:var(--white-90);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
    a{color:inherit;text-decoration:none}
    img{display:block;max-width:100%;height:auto}

    .wrap{max-width:var(--max-width);margin:20px auto;padding:16px;}

    /* subtle grain overlay to make depth (uses data URL lightweight pattern) */
    body::after{
      content:"";
      pointer-events:none;
      position:fixed; inset:0;
      background-image: radial-gradient(rgba(255,255,255,0.01) 0.5px, transparent 0.5px);
      background-size: 6px 6px;
      opacity:0.06;
      mix-blend-mode: overlay;
      z-index:0;
    }

    /* ---------- Topbar ---------- */
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;position:relative;z-index:2}
    .brand{display:flex;align-items:center;gap:12px}
    .brand .logo-wrap{width:48px;height:48px;border-radius:10px;overflow:hidden;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg, rgba(168,85,247,0.06), rgba(94,234,212,0.03));box-shadow:0 6px 22px rgba(10,6,12,0.6)}
    .brand h1{font-size:1.05rem;margin:0;font-weight:700;letter-spacing:0.6px;background:linear-gradient(90deg,var(--accent),var(--accent-2)); -webkit-background-clip:text; background-clip:text; color:transparent}
    .brand small{display:block;color:var(--muted);font-size:12px;margin-top:2px}

    .nav-actions{display:flex;gap:10px;align-items:center}
    .chip{padding:8px 12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.016), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);color:var(--muted);font-weight:600;font-size:13px}
    .chip.cta{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#051;box-shadow:0 8px 30px rgba(168,85,247,0.08);border:none;cursor:pointer}

    /* ---------- Layout: hero ---------- */
    .hero{display:grid;grid-template-columns: 1fr 360px;gap:18px;margin-top:18px;align-items:start}
    @media(max-width:980px){ .hero{grid-template-columns:1fr} }

    .card{
      position:relative;
      border-radius:var(--card-radius);
      background: linear-gradient(180deg,var(--panel),var(--panel-2));
      border:1px solid rgba(255,255,255,0.04);
      padding:16px;
      box-shadow: 0 12px 40px rgba(0,0,0,0.7);
      transition: transform .22s cubic-bezier(.2,.9,.3,1), box-shadow .22s;
      overflow:visible;
    }
    .card:hover{ transform: translateY(-6px); box-shadow: 0 24px 68px rgba(0,0,0,0.75) }

    /* Balance block */
    .balance-row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .balance-left{display:flex;flex-direction:column;gap:6px}
    .balance-label{color:var(--muted);font-weight:700;font-size:13px}
    .balance-value{font-weight:800;font-size:1.85rem; letter-spacing:0.6px; color:#fff}
    .small-muted{color:var(--muted);font-size:13px}

    .hero-right .status-card{display:flex;flex-direction:column;gap:10px;align-items:center;justify-content:center;height:100%}
    .status-pill{padding:8px 12px;border-radius:999px;font-weight:700;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02);color:var(--muted)}

    /* quick actions (mobile first friendly) */
    .quick-actions{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
    .action-item{display:flex;flex-direction:column;align-items:center;gap:8px;padding:10px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.02);min-width:84px;text-align:center;cursor:pointer}
    .action-item svg, .action-item img{width:28px;height:28px;filter:drop-shadow(0 8px 18px rgba(0,0,0,0.6))}
    .action-item p{margin:0;font-weight:700;color:#fff;font-size:13px}

    /* ---------- Market / insights ---------- */
    .market{margin-top:18px;display:grid;grid-template-columns:1fr 340px;gap:18px}
    @media(max-width:980px){ .market{grid-template-columns:1fr} }

    .market-cards{display:flex;gap:12px;flex-wrap:wrap}
    .market-card{min-width:140px;flex:1;padding:12px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.03)}
    .market-card h3{margin:0;font-size:0.95rem;color:var(--muted)}
    .market-price{font-weight:800;font-size:1.05rem;margin-top:8px;color:#fff}
    .market-change.positive{color:var(--accent-2);font-weight:700}
    .market-change.negative{color:var(--danger);font-weight:700}

    .market-list{margin-top:12px;border-radius:12px;overflow:hidden}
    .market-row{display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.02);align-items:center}
    .coin{font-weight:700;color:#fff}
    .price{font-weight:700}

    /* ---------- Announcements & recent ---------- */
    .notice{padding:10px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.02);margin-bottom:10px}
    .notice h4{margin:0 0 6px 0}

    /* ---------- Bottom nav ---------- */
    .bottom-nav{position:fixed;left:50%;transform:translateX(-50%);bottom:14px;background:linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.006));border:1px solid rgba(255,255,255,0.03);padding:10px 14px;border-radius:999px;display:flex;gap:12px;box-shadow:0 10px 40px rgba(0,0,0,0.6);z-index:3}
    .nav-item{display:flex;flex-direction:column;align-items:center;gap:6px;color:var(--muted);text-decoration:none;font-weight:700;font-size:12px;padding:6px 8px}
    .nav-item img{width:18px;height:18px;opacity:0.95;filter:grayscale(0.1)}
    .nav-item.active{color:var(--accent);transform:translateY(-4px)}

    /* ---------- small helpers ---------- */
    .muted-small{color:var(--muted);font-size:13px}
    .badge{padding:6px 10px;border-radius:999px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#051;font-weight:800}
    .tx-list{max-height:220px;overflow:auto;padding:6px}

    /* ---------- responsiveness ---------- */
    @media(max-width:640px){
      .wrap{padding:12px;margin:12px}
      .brand h1{font-size:1rem}
      .hero{grid-template-columns:1fr}
      .market{grid-template-columns:1fr}
      .bottom-nav{left:50%;right:auto; padding:8px 12px}
      .card{padding:12px}
      .balance-value{font-size:1.4rem}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <!-- Top bar -->
    <div class="topbar">
      <div class="brand">
        <div class="logo-wrap">
          <!-- using uploaded logo local path (replace with your hosted logo path as needed) -->
          <img src="/img/logo.png" alt="CryptoYieldPro logo" style="width:38px;height:38px;object-fit:cover" onerror="this.onerror=null;this.src='/img/logo.png'">
        </div>
        <div>
          <h1>CryptoYieldPro</h1>
          <small>Premium crypto bonuses & membership</small>
        </div>
      </div>

      <div class="nav-actions">
        <div class="chip">Welcome back</div>
        <button class="chip cta" onclick="location.href='account.html'">My Account</button>
      </div>
    </div>

    <!-- Hero -->
    <div class="hero" aria-label="overview">
      <!-- left: balance + quick actions -->
      <div class="card" style="position:relative;overflow:visible;">
        <div class="balance-row">
          <div class="balance-left">
            <div class="balance-label">Account Balance</div>
            <div class="balance-value" id="balanceValue">$0.00</div>
            <div class="small-muted">Available balance reflects confirmed deposits & payouts</div>
          </div>

          <div style="text-align:right">
            <div class="small-muted">Membership</div>
            <div class="badge" id="membershipBadge">None</div>
            <div style="height:8px"></div>
            <div class="small-muted">Next Payout</div>
            <div id="nextPayout" class="muted-small">—</div>
          </div>
        </div>

        <div class="quick-actions" role="navigation" aria-label="quick-actions">
          <div class="action-item" onclick="location.href='deposit.html'">
            <img src="/img/deposit.png" alt="deposit"><p>Deposit</p>
          </div>
          <div class="action-item" onclick="location.href='withdraw.html'">
            <img src="/img/withdraw.png" alt="withdraw"><p>Withdraw</p>
          </div>
          <div class="action-item" onclick="location.href='upgrade.html'">
            <img src="/img/vip-card.png" alt="vip"><p>Membership</p>
          </div>
          <div class="action-item" onclick="location.href='internal-transfer.html'">
            <img src="/img/money.png" alt="transfer"><p>Transfer</p>
          </div>
        </div>
      </div>

      <!-- right: small status / summary -->
      <div class="card hero-right">
        <div class="status-card">
          <div style="display:flex;justify-content:space-between;align-items:center;width:100%">
            <div style="font-weight:800">Platform Status</div>
            <div class="status-pill">Online</div>
          </div>

          <div style="display:flex;gap:8px;flex-direction:column;margin-top:8px;width:100%">
            <div class="small-muted">Pending Deposits</div>
            <div id="pendingCount" style="font-weight:800">0</div>

            <div class="small-muted" style="margin-top:8px">Pending Withdrawals</div>
            <div id="pendingWithdraw" style="font-weight:800">0</div>
          </div>

          <div style="height:8px"></div>
          <button class="chip cta" onclick="location.href='admin.html'">Admin Panel</button>
        </div>
      </div>
    </div>

    <!-- Market Section -->
    <div class="market" aria-label="market">
      <div class="card" style="min-height:220px;position:relative;">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h2 style="margin:0;font-size:1.05rem">Market Snapshot</h2>
          <div class="muted-small">Live prices • Updated every 10s</div>
        </div>

        <div class="market-cards" id="marketCards" style="margin-top:14px">
          <div class="market-card" data-coin="bitcoin">
            <h3>BTC / USDT</h3>
            <div class="market-price" data-price-id="bitcoin">—</div>
            <div class="market-change" data-change-id="bitcoin"></div>
          </div>
          <div class="market-card" data-coin="ethereum">
            <h3>ETH / USDT</h3>
            <div class="market-price" data-price-id="ethereum">—</div>
            <div class="market-change" data-change-id="ethereum"></div>
          </div>
          <div class="market-card" data-coin="tether">
            <h3>USDT</h3>
            <div class="market-price" data-price-id="tether">—</div>
            <div class="market-change" data-change-id="tether"></div>
          </div>
        </div>

        <div class="market-list" style="margin-top:14px">
          <div class="market-row" data-coin="bitcoin">
            <div class="coin">BTC/USDT</div>
            <div style="display:flex;gap:12px;align-items:center">
              <div class="price" data-price-id="bitcoin">—</div>
              <div class="change" data-change-id="bitcoin"></div>
            </div>
          </div>
          <div class="market-row" data-coin="ethereum">
            <div class="coin">ETH/USDT</div>
            <div style="display:flex;gap:12px;align-items:center">
              <div class="price" data-price-id="ethereum">—</div>
              <div class="change" data-change-id="ethereum"></div>
            </div>
          </div>
          <div class="market-row" data-coin="dogecoin">
            <div class="coin">DOGE/USDT</div>
            <div style="display:flex;gap:12px;align-items:center">
              <div class="price" data-price-id="dogecoin">—</div>
              <div class="change" data-change-id="dogecoin"></div>
            </div>
          </div>
          <div class="market-row" data-coin="eos">
            <div class="coin">EOS/USDT</div>
            <div style="display:flex;gap:12px;align-items:center">
              <div class="price" data-price-id="eos">—</div>
              <div class="change" data-change-id="eos"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- right column: activity / announcements -->
      <div class="card" style="min-height:220px">
        <h3 style="margin:0 0 10px 0">Announcements</h3>
        <div class="small-muted">Latest updates & status</div>

        <div style="margin-top:12px">
          <div class="notice">
            <div style="font-weight:700">New Memberships</div>
            <div class="muted-small">V3, V4 & V5 packages added — check upgrade page.</div>
          </div>

          <div class="notice">
            <div style="font-weight:700">Manual Withdrawals</div>
            <div class="muted-small">Withdraw requests are manual and require admin approval.</div>
          </div>
        </div>

        <div style="height:14px"></div>
        <h4 style="margin-bottom:8px">Recent activity</h4>
        <div id="recentActivity" class="muted-small">No recent activity</div>
      </div>
    </div>

  </div>

  <!-- bottom nav -->
  <nav class="bottom-nav" role="navigation" aria-label="bottom">
    <a class="nav-item active" href="home.html"><img src="/img/house.png" alt=""><span>Home</span></a>
    <a class="nav-item" href="trade.html"><img src="/img/trade.png" alt=""><span>Trade</span></a>
    <a class="nav-item" href="internal-transfer.html"><img src="/img/transfer.png" alt=""><span>Transfer</span></a>
    <a class="nav-item" href="account.html"><img src="/img/myaccount.png" alt=""><span>Account</span></a>
  </nav>

  <!-- Keep your existing scripts (market-prices and main script) -->
  <script src="/js/language.js"></script>
  <script>document.addEventListener('DOMContentLoaded', initLanguageSelector);</script>

  <script src="/script.js"></script>
  <script src="/js/market-prices.js"></script>

  <script>
    // MarketPrices usage + profile fetch to update UI
    document.addEventListener('DOMContentLoaded', () => {
      try {
        if (typeof MarketPrices !== 'undefined' && MarketPrices.start) {
          MarketPrices.start(['bitcoin','ethereum','dogecoin','eos','tether','cardano','binancecoin','solana'], 10000);
        }
      } catch(e){ console.warn('MarketPrices not available', e); }

      // Update profile UI
      (function profileUpdater(){
        fetch('/api/profile', { credentials: 'include' })
          .then(r => {
            if (!r.ok) return null;
            return r.json();
          })
          .then(j => {
            if (!j || !j.user) return;
            const u = j.user;
            const val = Number(u.balance || 0);
            document.getElementById('balanceValue').innerText = new Intl.NumberFormat(undefined, { style:'currency', currency:'USD', maximumFractionDigits:2 }).format(val);
            document.getElementById('membershipBadge').innerText = (u.membership && u.membership.tier) ? u.membership.tier : (u.currentMembership?.tier || 'None');
            // Show pending counts if server provides them
            document.getElementById('pendingCount').innerText = u.pendingDeposits ?? 0;
            document.getElementById('pendingWithdraw').innerText = u.pendingWithdrawals ?? 0;
            // recent activity
            const recent = u.recentActivity || [];
            document.getElementById('recentActivity').innerText = recent.length ? recent.slice(0,5).map(r=>`${r.type} • ${r.amount}`).join('\\n') : 'No recent activity';
          })
          .catch(()=>{/* silent */});
        // refresh periodically
        setInterval(profileUpdater, 8000);
      })();

      // Smooth internal link fade
      const overlay = document.createElement('div');
      overlay.style.position='fixed'; overlay.style.inset=0; overlay.style.background='radial-gradient(circle, rgba(168,85,247,0.06), rgba(0,0,0,0.95))'; overlay.style.opacity=0; overlay.style.transition='opacity .35s'; overlay.style.pointerEvents='none'; document.body.appendChild(overlay);

      document.querySelectorAll('a').forEach(link=>{
        const href = link.getAttribute('href');
        if (!href || href.startsWith('#') || href.startsWith('http') || link.target === '_blank') return;
        link.addEventListener('click', e=>{
          e.preventDefault();
          overlay.style.opacity=1;
          setTimeout(()=> window.location.href = href, 320);
        });
      });
    });
  </script>
</body>
</html>
