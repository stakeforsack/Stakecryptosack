<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Account â€” CryptoYieldPro</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg-1:#040406;
      --bg-2:#08080b;
      --glass:rgba(255,255,255,0.03);
      --glass-border:rgba(255,255,255,0.06);
      --accent:#a855f7;
      --accent-2:#5eead4;
      --muted:#9aa3b2;
      --danger:#ff6b6b;
      --radius:14px;
    }

    html,body{
      margin:0;
      font-family:Inter,system-ui;
      background:
        radial-gradient(800px 500px at 10% 10%, rgba(168,85,247,0.06), transparent 8%),
        radial-gradient(600px 400px at 90% 90%, rgba(94,234,212,0.03), transparent 6%),
        linear-gradient(180deg, var(--bg-1), var(--bg-2));
      color:#eaf3ff;
      padding-bottom:100px;
      -webkit-font-smoothing:antialiased;
    }

    .wrap { max-width:900px; margin:0 auto; padding:20px; }

    /* Profile section */
    .profile-box{
      text-align:center;
      padding-top:18px;
      padding-bottom:4px;
    }
    .avatar{
      width:110px;height:110px;border-radius:50%;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      display:flex;align-items:center;justify-content:center;
      font-size:2.4rem;font-weight:800;color:#021;
      box-shadow:0 0 40px rgba(168,85,247,0.35);
      margin:0 auto 12px;
    }
    .username{font-size:1.6rem;font-weight:800}
    .vip-badge{
      margin-top:8px;display:inline-block;padding:6px 16px;
      background:linear-gradient(90deg, gold, #ffd55c);
      border-radius:999px;color:#241e00;font-weight:800;
      font-size:0.9rem;letter-spacing:0.3px;
    }

    .card{
      background:var(--glass);
      border:1px solid var(--glass-border);
      border-radius:var(--radius);
      padding:18px;
      margin-top:20px;
      backdrop-filter:blur(12px);
      box-shadow:0 18px 50px rgba(0,0,0,0.55);
    }

    .card-title{
      color:var(--muted);
      font-size:0.9rem;
      font-weight:600;
    }
    .card-balance{
      font-size:2.2rem;
      font-weight:800;
      margin-top:6px;
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      -webkit-background-clip:text;background-clip:text;
      color:transparent;
    }

    /* Menu */
    .menu a{
      display:block;margin-top:14px;padding:14px;
      border-radius:var(--radius);
      background:rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.04);
      color:white;text-decoration:none;font-size:1rem;
      font-weight:600;transition:0.25s;
    }
    .menu a:hover{
      transform:translateY(-3px);
      border-color:var(--accent);
      box-shadow:0 0 15px rgba(168,85,247,0.4);
    }

    /* Logout */
    .logout-btn{
      width:100%;margin-top:22px;padding:14px;
      background:linear-gradient(135deg,#ff4949,#c90000);
      border:none;border-radius:var(--radius);
      color:white;font-size:1rem;font-weight:700;
      cursor:pointer;
    }

    /* Bottom nav */
    .bottom-nav{
      position:fixed;bottom:16px;left:50%;transform:translateX(-50%);
      background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.04);
      border-radius:999px;padding:10px 16px;
      display:flex;gap:18px;box-shadow:0 18px 45px rgba(0,0,0,0.6);z-index:999;
    }
    .nav-item{
      display:flex;flex-direction:column;align-items:center;
      color:var(--muted);font-size:0.85rem;text-decoration:none;
      font-weight:700;
    }
    .nav-item img{width:22px;height:22px;margin-bottom:4px}
    .nav-item.active{color:var(--accent);transform:translateY(-4px) scale(1.04)}
  </style>
</head>

<body>

<div class="wrap">

  <div class="profile-box">
    <div id="avatar" class="avatar">U</div>
    <div id="username" class="username">Loading...</div>
    <div id="vipBadge" class="vip-badge" style="display:none"></div>
  </div>

  <div class="card">
    <div class="card-title">Total Balance</div>
    <div id="totalBalance" class="card-balance">0.00</div>
  </div>

  <div class="menu">
    <a href="profile.html">Profile Settings</a>
    <a href="security.html">Security</a>
    <a href="wallet.html">Wallet Balance</a>
    <a href="transaction-history.html">Transaction History</a>
    <a href="support.html">Customer Support</a>
  </div>

  <button class="logout-btn" onclick="logout()">Logout</button>

</div>

<!-- bottom nav -->
<nav class="bottom-nav">
  <a href="home.html" class="nav-item">
    <img src="/img/house.png"><span>Home</span>
  </a>
  <a href="trade.html" class="nav-item">
    <img src="/img/trade.png"><span>Trade</span>
  </a>
  <a href="internal-transfer.html" class="nav-item">
    <img src="/img/transfer.png"><span>Transfer</span>
  </a>
  <a href="account.html" class="nav-item active">
    <img src="/img/myaccount.png"><span>Account</span>
  </a>
</nav>

<script>
async function logout(){
  await fetch("/api/logout",{method:"POST",credentials:"include"});
  window.location.href="login.html";
}

document.addEventListener("DOMContentLoaded", async () => {
  try {
    const res = await fetch("/api/profile",{credentials:"include"});

    if(res.status === 401){
      window.location.href = "login.html";
      return;
    }

    const data = await res.json();
    const user = data.user || {};

    // Username + avatar
    const uname = user.username || "User";
    document.getElementById("username").textContent = uname;
    document.getElementById("avatar").textContent = uname[0].toUpperCase();

    // VIP / Membership
    if(user.membership && user.membership.tier){
      document.getElementById("vipBadge").style.display = "inline-block";
      document.getElementById("vipBadge").textContent = user.membership.tier;
    }

    // Balance (backend uses user.balance)
    const total = Number(user.balance || 0);
    document.getElementById("totalBalance").textContent =
      total.toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:6});

  } catch(err){
    console.error("Account load error:", err);
  }
});
</script>

</body>
</html>
